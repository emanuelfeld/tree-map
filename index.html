<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>dctrees</title>

    <link rel="stylesheet" href="stylesheets/index.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <link rel="shortcut icon" type="image/x-icon" href="assets/dc16.ico" >
		<link href="http://libs.cartocdn.com/cartodb.js/v3/3.13/themes/css/cartodb.css" rel="stylesheet">
		<meta content="initial-scale=1.0, user-scalable=no" name="viewport">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  	<script type="text/javascript">var switchTo5x=true;</script>
  	<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
  	<script type="text/javascript">stLight.options({publisher: "45b51a17-fe6c-479b-aab4-28d008c79a84", doNotHash: true, doNotCopy: false, hashAddressBar: false});</script>
  </head>
<body style="margin:0 auto">
		<header class="header">
			
			<div id="logo"><img src="assets/dc64green.png"></div>
			<div id="title"> 
			plant a tree @ <input id="search_address" placeholder="this street address" type="text"></div>
		</header>

		<div id="map"></div>
		<script src="http://libs.cartocdn.com/cartodb.js/v3/3.13/cartodb.js"></script>

		<script>
			function main() {
				cartodb.createVis('map',
					'https://evonfriedland.cartodb.com/api/v2/viz/90ac791c-e0de-11e4-84b0-0e43f3deba5a/viz.json', {
						shareable: false,
						title: false,
						description: false,
						search: false,
						tiles_loader: true,
						center_lat: 38.8993488,
						center_lon: -77.0145665,
						zoom: 11
					}).done(function(vis, layers) {
					layers[1].setInteraction(true);
					layers[1].on('featureOver', function(e, latlng, pos, data) {
						cartodb.log.log(e, latlng, pos, data);
					});

					var map = vis.getNativeMap();

					$(document).ready(function() {
						$("input").on("keydown", function search(e) {
							if (e.keyCode == 13) {
								var add = $('#search_address').val() + " Washington DC";
								console.log(add);
								var url = "http://nominatim.openstreetmap.org/search/" +
									encodeURIComponent(add) + "?format=json";
								var search_coor = httpGet(url);
								map.panTo(search_coor);
								map.setZoom(17);
							}
						});
					});
				}).error(function(err) {
					console.log(err);
				});
			}

			function httpGet(theUrl) {
				var xmlHttp = null;
				xmlHttp = new XMLHttpRequest();
				xmlHttp.open("GET", theUrl, false);
				xmlHttp.send(null);
				var address_json = JSON.parse(xmlHttp.responseText);
				var lat = address_json[0]['lat'];
				var lon = address_json[0]['lon'];
				return [lat, lon];
			}

			window.onload = main;
		</script>


		<footer class="footer">
			<a href="/tree-map"> Map </a> 
			<a href="about.html"> About </a> 
			<a href="about.html#contact"> Contact </a>
			<span class='st_facebook' st_title='Want a tree planted on your DC block? Check out http://getdctrees.org' displayText=''></span>
			<span class='st_twitter' st_title='Want a tree planted on your DC block? Check out http://getdctrees.org' st_via='' st_url='' displayText=''></span>
			<span class='st_reddit' st_title='Want a tree planted on your DC block? Check out http://getdctrees.org' st_url='http://getdctrees.org' displayText=''></span>
		</footer>	

    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-61502361-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
